<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<div th:replace="~{xdm/include/head :: head}"></div>

<form  method="post" id="form">
<input type="hidden" id="shSeq" name="shSeq">
	<!-- ### -->

	<section class="content">
		<div class="container-fluid">

			<div class="block-header">
				<h2>발주</h2>
			</div>

			<!-- Input -->
			<div class="row clearfix">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="card">
						<div class="header">
							<h2>발주</h2>
							<ul class="header-dropdown m-r--5">
								<li class="dropdown"><a href="javascript:void(0);"
									class="dropdown-toggle" data-toggle="dropdown" role="button"
									aria-haspopup="true" aria-expanded="false"> <i
										class="material-icons">more_vert</i>
								</a>
									<ul class="dropdown-menu pull-right">
										<li><a href="javascript:void(0);">Action</a></li>
										<li><a href="javascript:void(0);">Another action</a></li>
										<li><a href="javascript:void(0);">Something else here</a></li>
									</ul></li>
							</ul>
						</div>
						<div class="body">
							<h2 class="card-inside-title">
								<small>주문자<span style="color: red;">*</span></small>
							</h2>
							<div class="row clearfix">
								<div class="col-sm-12">
									<div class="row clearfix">
										<div class="col-sm-3">
											<select class="form-control show-tick" id="memSeq" name="memSeq"     >
												<option value="">선택하세요</option>
												<option th:each="list : ${list}" th:text="${list.memName}" th:value="${list?.memSeq}" ></option>
											</select> <span id="codeGroupError"
												style="color: red; font-size: 10px;"></span>
										</div>
									</div>
								</div>
								<div class="col-sm-3">
									<div class="form-group">
										<div class="form-line">
											<h2 class="card-inside-title">
												<small>주문자ID</small>
											</h2>
											<div  name="memId" id="memId">&nbsp;</div>
										</div>
									</div>
								</div>
								<div class="col-sm-3">
									<div class="form-group">
										<div class="form-line">
											<h2 class="card-inside-title">
												<small>배송주소</small>
											</h2>
											<div  name="memAddress" id="memAddress">&nbsp;</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row clearfix">
								<div class="col-sm-12">
									<div class="row clearfix">
										<div class="col-sm-3">
										<small style="font-size: 11px; color: #999; display: block; margin-top: 5px;">신발<span style="color: red;">*</span></small>
											<select class="form-control show-tick" id="shName" name="shName"  >
												<option value="">선택하세요</option>
												<option th:each="list : ${shoes}" th:text="${list.shName}" th:value="${list.shName}"></option>
											</select> <span id="codeGroupError"
												style="color: red; font-size: 10px;"></span>
										</div>
										<div class="col-sm-3">
										<small style="font-size: 11px; color: #999; display: block; margin-top: 5px;">사이즈<span style="color: red;">*</span></small>
											<select class="form-control show-tick" id="shSizeCd" name="shSizeCd" disabled>
												<option value="">선택하세요</option>
											</select> <span id="codeGroupError"
												style="color: red; font-size: 10px;"></span>
										</div>
									</div>
								</div>
								 <div class="col-sm-3">
									<div class="form-group">
										<div class="form-line">
											<h2 class="card-inside-title">
												<small>수량</small>
											</h2>
											<input type="text" id="shOrderCount" name="shOrderCount" class="form-control">
										</div>
									</div>
								</div> 
								 
							</div>
							<div class="row clearfix">
								<div class="col-sm-12">
									<div class="row clearfix">
										<!-- <div class="col-sm-3">
											<h2 class="card-inside-title">
												<small>사용여부</small>
											</h2>
											<select class="form-control show-tick ">
												<option value="">사용</option>

											</select>
										</div>
										<div class="col-sm-3">
											<div class="form-group">
												<div class="form-line">
													<h2 class="card-inside-title">
														<small>순서</small>
													</h2>
													<input type="text" class="form-control" placeholder="" />
												</div>
											</div>
										</div> -->

									</div>
									<div class="col-sm-12">
										<!-- <div class="form-group">
											<div class="form-line">
												<h2 class="card-inside-title">
													<small>설명</small>
												</h2>
												<textarea rows="4" class="form-control no-resize"
													placeholder=""></textarea>
											</div>
										</div> -->
										<a role="button" class="btn btn-light" style="float: left;"
											th:href="@{/FactoryOrderXdmList}"> <svg
												xmlns="http://www.w3.org/2000/svg" width="16" height="16"
												fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
                                                <path
													fill-rule="evenodd"
													d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5" />
                                            </svg>
										</a>
										     &nbsp; &nbsp;
                                        <!-- 업데이트 삭제 -->
                                       <button type="button" class="btn btn-danger" id="btnUelete">
	                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
	                                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
	                                        <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
	                                      </svg>
	                                    </button>
										<button type="button" class="btn btn-primary"
											style="float: right;" id="btnSubmit" data-toggle="modal">
											<svg xmlns="http://www.w3.org/2000/svg" width="16"
												height="16" fill="currentColor" class="bi bi-database"
												viewBox="0 0 16 16">
                                                <path
													d="M4.318 2.687C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4c0-.374.356-.875 1.318-1.313M13 5.698V7c0 .374-.356.875-1.318 1.313C10.766 8.729 9.464 9 8 9s-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777A5 5 0 0 0 13 5.698M14 4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16s3.022-.289 4.096-.777C13.125 14.755 14 14.007 14 13zm-1 4.698V10c0 .374-.356.875-1.318 1.313C10.766 11.729 9.464 12 8 12s-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10s3.022-.289 4.096-.777A5 5 0 0 0 13 8.698m0 3V13c0 .374-.356.875-1.318 1.313C10.766 14.729 9.464 15 8 15s-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13s3.022-.289 4.096-.777c.324-.147.633-.323.904-.525" />
                                              </svg>
										</button>

									</div>
									
									<!-- 삭제 모달 -->
											<div class="modal fade" id="modalConfirm" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
												<div class="modal-dialog modal-dialog-centered">
													<div class="modal-content">
														<div class="modal-header">
															<h5 class="modal-title" id="modalConfirmTitle">title</h5>
															<!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">??</button> -->
														</div>
														<div class="modal-body" id="modalConfirmBody">
															body
														</div>
														<div class="modal-footer">
															<!-- <button type="button" class="btn btn-outline-secondary btn-sm btn_custom" data-bs-dismiss="modal"></button> -->
															<!-- <button type="button" class="btn btn-danger btn-sm btn_custom" name="" id="btnModalDelete">영구삭제</button> -->
															<button type="button" class="btn btn-sm btn_custom" name="" id="" href="#">닫기</button>
															<button type="button" class="btn btn-danger btn-sm btn_custom" name="" id="btnModalUelete">삭제</button>
														</div>
													</div>
												</div>
											</div>
											
										<!-- 삭제모달 AND -->
									
									
									
									
									
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
</form>

<!-- Jquery Core Js -->
<script src="/xdm/template/master/plugins/jquery/jquery.min.js"></script>

<!-- Bootstrap Core Js -->
<script src="/xdm/template/master/plugins/bootstrap/js/bootstrap.js"></script>

<!-- Select Plugin Js -->
<script
	src="/xdm/template/master/plugins/bootstrap-select/js/bootstrap-select.js"></script>

<!-- Slimscroll Plugin Js -->
<script
	src="/xdm/template/master/plugins/jquery-slimscroll/jquery.slimscroll.js"></script>

<!-- Waves Effect Plugin Js -->
<script src="/xdm/template/master./plugins/node-waves/waves.js"></script>

<!-- Autosize Plugin Js -->
<script src="/xdm/template/master/plugins/autosize/autosize.js"></script>

<!-- Moment Plugin Js -->
<script src="/xdm/template/master/plugins/momentjs/moment.js"></script>

<!-- Bootstrap Material Datetime Picker Plugin Js -->
<script
	src="/xdm/template/master/plugins/bootstrap-material-datetimepicker/js/bootstrap-material-datetimepicker.js"></script>

<!-- Bootstrap Datepicker Plugin Js -->
<script
	src="/xdm/template/master/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>

<!-- Custom Js -->
<script src="/xdm/template/master/js/admin.js"></script>
<script src="/xdm/template/master/js/pages/forms/basic-form-elements.js"></script>

<!-- Demo Js -->
<script src="/xdm/template/master/js/demo.js"></script>

<script type="text/javascript">

//	주문자 선택시 주문자 정보 뜨는Proc
	$('#memSeq').on('change', function () {
	    $.ajax({
	    	async: true 
			,cache: false
			,type: "post"
			/* ,dataType:"json" */
			,url: "/selectOneMemberProc"
			/* ,data : $("#formLogin").serialize() */
			,data : { "memSeq" : $("#memSeq").val()}
			,success: function(response) {
				   $('#memId').val(response.memId);
				    $('#memAddress').val(response.memAddress);
				    $('#memId').text(response.memId);
				    $('#memAddress').text(response.memAddress);
	         
	        }
	        
	    });
	});
//신발 선택시 size보여주는 Proc
$('#shName').on('change', function () {
	let selectedshName =  $(this).val();
 
    if (selectedshName != "") {
	    $.ajax({
	    	async: true 
			,cache: false
			,type: "post"
			/* ,dataType:"json" */
			,url: "/selectOneShoesSizeProc"
			/* ,data : $("#formLogin").serialize() */
			,data : { "shName" : $("#shName").val()}
			,success: function(response) {
				  
				//sizeCd셀렉트박스 초기화
				 $('#shSizeCd').empty();
				  $('#shSizeCd').append('<option value="">선택하세요</option>');
				//셀렉트박스 활성화
				$('#shSizeCd').prop('disabled', false);
				
				//컨트롤러에서 받아온 sizeList를 배열로 뿌려줌
				response.sizeList.forEach(function(item) {
					//받아온 shSizeCd를 클라이언트에서 보일땐 변환해서 보여줌
					  let displayText = item.shSizeCd; 
					  if (item.shSizeCd === 8) {
	                        displayText = '230';
	                    } else if (item.shSizeCd === 9) {
	                        displayText = '240';
	                    
	                    } else if (item.shSizeCd === 10) {
	                        displayText = '250';
	                    
	                    } else if (item.shSizeCd ===11) {
	                        displayText = '260';
	                    
	                    } else if (item.shSizeCd ===12) {
	                        displayText = '270';
	                 
	                    } else if (item.shSizeCd === 13) {
	                        displayText = '280';
	                    }else{
	                    	
	                    }
	              
			        $('#shSizeCd').append('<option value="' + item.shSizeCd + '">' + displayText + '</option>');
			    });
				
                $('#shSizeCd').selectpicker('refresh');
	        }
	        
	    });
    } else {
        //sizeCd셀렉트박스 초기화
		 $('#shSizeCd').empty();
		 $('#shSizeCd').append('<option value="">선택하세요</option>');
        // 선택하세요로 돌아온 경우 → 두 번째 셀렉트박스 다시 비활성화
        $('#shSizeCd').prop('disabled', true);
        $('#shSizeCd').selectpicker('refresh');
    }
});

//신발이선택되고 사이즈도 선택됐을씨 shSeq를 가져오는Proc
$('#shSizeCd').on('change', function() {
//     let selectedshName = $('#shName').val();
//     let selectedshSizeCd = $(this).val();
	 if ($('#shName').val() !== "" && $('#shSizeCd').val() !== "") {
        $.ajax({
            async: true,
            cache: false,
            type: "post",
            url: "/selectOneShoesProc", 
            data: {"shName" : $("#shName").val(),"shSizeCd" : $("#shSizeCd").val()},
            success: function(response) {
              	
            	 $("#shSeq").val(response.shSeq);
            }
        });
    }
});

document.getElementById("btnSubmit").onclick= function(){

	let form = document.getElementById("form");
	form.action="/OrderXdmInst1";
	form.submit();

}

document.getElementById("btnSubmit").onclick = function (e) {
    e.preventDefault(); // 기본 제출 막기

    // 각각의 필드 값 가져오기
    let memSeq = $("#memSeq").val();
    let shName = $("#shName").val();
    let shSizeCd = $("#shSizeCd").val();
    let shSeq = $("#shSeq").val(); // 숨겨진 input
    let shOrderCount = $("#shOrderCount").val(); // ✅ 수량값도 가져와야 함

    // 유효성 검사
    if (!memSeq) {
        alert("주문자를 선택해주세요.");
        $("#memSeq").focus();
        return;
    }

    if (!shName) {
        alert("신발을 선택해주세요.");
        $("#shName").focus();
        return;
    }

    if (!shSizeCd) {
        alert("사이즈를 선택해주세요.");
        $("#shSizeCd").focus();
        return;
    }

    if (!shOrderCount || isNaN(shOrderCount) || parseInt(shOrderCount) <= 0) {
        alert("수량은 1개 이상 입력해주세요.");
        $("#shOrderCount").focus();
        return;
    }

    // 모든 값이 유효할 경우 폼 제출
    let form = document.getElementById("form");
    form.action = "/OrderXdmInst1";
    form.submit();
};



</script>





</body>
</html>
